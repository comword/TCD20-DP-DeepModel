Model: "vtn_1"
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
Layer (type)                                                                                                                        Output Shape                                                                            Param #                                         Connected to                                                                                                                        
================================================================================================================================================================================================================================================================================================================================================================================================================
input_1 (InputLayer)                                                                                                                [(None, 3, 16, 224, 224)]                                                               0                                                                                                                                                                                   
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.shape (TFOpLambda)                                                                                                     (5,)                                                                                    0                                               input_1[0][0]                                                                                                                       
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem (SlicingOpLambda)                                                                                          ()                                                                                      0                                               tf.compat.v1.shape[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_2 (SlicingOpLambda)                                                                                        ()                                                                                      0                                               tf.compat.v1.shape[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.transpose (TFOpLambda)                                                                                                 (None, 16, 224, 224, 3)                                                                 0                                               input_1[0][0]                                                                                                                       
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.math.multiply (TFOpLambda)                                                                                                       ()                                                                                      0                                               tf.__operators__.getitem[0][0]                                                                                                      
                                                                                                                                                                                                                                                                            tf.__operators__.getitem_2[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_3 (SlicingOpLambda)                                                                                        ()                                                                                      0                                               tf.compat.v1.shape[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_4 (SlicingOpLambda)                                                                                        ()                                                                                      0                                               tf.compat.v1.shape[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_1 (SlicingOpLambda)                                                                                        ()                                                                                      0                                               tf.compat.v1.shape[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.reshape (TFOpLambda)                                                                                                             (None, None, None, None)                                                                0                                               tf.compat.v1.transpose[0][0]                                                                                                        
                                                                                                                                                                                                                                                                            tf.math.multiply[0][0]                                                                                                              
                                                                                                                                                                                                                                                                            tf.__operators__.getitem_3[0][0]                                                                                                    
                                                                                                                                                                                                                                                                            tf.__operators__.getitem_4[0][0]                                                                                                    
                                                                                                                                                                                                                                                                            tf.__operators__.getitem_1[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
efficientnetb0 (Functional)                                                                                                         (None, 7, 7, 384)                                                                       3759267                                         tf.reshape[0][0]                                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
layer_normalization (LayerNormalization)                                                                                            (None, 7, 7, 384)                                                                       768                                             efficientnetb0[0][0]                                                                                                                
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
global_max_pooling2d (GlobalMaxPooling2D)                                                                                           (None, 384)                                                                             0                                               layer_normalization[0][0]                                                                                                           
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.reshape_1 (TFOpLambda)                                                                                                           (None, None, None)                                                                      0                                               global_max_pooling2d[0][0]                                                                                                          
                                                                                                                                                                                                                                                                            tf.__operators__.getitem[0][0]                                                                                                      
                                                                                                                                                                                                                                                                            tf.__operators__.getitem_2[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.shape_1 (TFOpLambda)                                                                                                   (3,)                                                                                    0                                               tf.reshape_1[0][0]                                                                                                                  
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_5 (SlicingOpLambda)                                                                                        ()                                                                                      0                                               tf.compat.v1.shape_1[0][0]                                                                                                          
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_7 (SlicingOpLambda)                                                                                        ()                                                                                      0                                               tf.compat.v1.shape_1[0][0]                                                                                                          
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.broadcast_to (TFOpLambda)                                                                                                        (None, 1, 384)                                                                          0                                               tf.__operators__.getitem_5[0][0]                                                                                                    
                                                                                                                                                                                                                                                                            tf.__operators__.getitem_7[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.concat (TFOpLambda)                                                                                                              (None, None, 384)                                                                       0                                               tf.broadcast_to[0][0]                                                                                                               
                                                                                                                                                                                                                                                                            tf.reshape_1[0][0]                                                                                                                  
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.shape_2 (TFOpLambda)                                                                                                   (3,)                                                                                    0                                               tf.concat[0][0]                                                                                                                     
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_8 (SlicingOpLambda)                                                                                        ()                                                                                      0                                               tf.compat.v1.shape_2[0][0]                                                                                                          
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.math.floormod (TFOpLambda)                                                                                                       ()                                                                                      0                                               tf.__operators__.getitem_8[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.math.subtract (TFOpLambda)                                                                                                       ()                                                                                      0                                               tf.math.floormod[0][0]                                                                                                              
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.math.floormod_1 (TFOpLambda)                                                                                                     ()                                                                                      0                                               tf.math.subtract[0][0]                                                                                                              
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
input_2 (InputLayer)                                                                                                                [(None, 16)]                                                                            0                                                                                                                                                                                   
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.convert_to_tensor_2 (TFOpLambda)                                                                                                 (2, 2)                                                                                  0                                               tf.math.floormod_1[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.pad_3 (TFOpLambda)                                                                                                     (None, None)                                                                            0                                               input_2[0][0]                                                                                                                       
                                                                                                                                                                                                                                                                            tf.convert_to_tensor_2[0][0]                                                                                                        
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_6 (SlicingOpLambda)                                                                                        ()                                                                                      0                                               tf.compat.v1.shape_1[0][0]                                                                                                          
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.cast_2 (TFOpLambda)                                                                                                              (None, None)                                                                            0                                               tf.compat.v1.pad_3[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.zeros (TFOpLambda)                                                                                                               (None, None)                                                                            0                                               tf.__operators__.getitem_6[0][0]                                                                                                    
                                                                                                                                                                                                                                                                            tf.__operators__.getitem_5[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.math.floormod_2 (TFOpLambda)                                                                                                     (None, None)                                                                            0                                               tf.cast_2[0][0]                                                                                                                     
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.pad (TFOpLambda)                                                                                                       (None, None)                                                                            0                                               tf.zeros[0][0]                                                                                                                      
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.convert_to_tensor (TFOpLambda)                                                                                                   (3, 2)                                                                                  0                                               tf.math.floormod_1[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.shape_4 (TFOpLambda)                                                                                                   (2,)                                                                                    0                                               tf.math.floormod_2[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.transpose_1 (TFOpLambda)                                                                                               (None, None)                                                                            0                                               tf.compat.v1.pad[0][0]                                                                                                              
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.ones (TFOpLambda)                                                                                                                (None, None)                                                                            0                                               tf.__operators__.getitem_5[0][0]                                                                                                    
                                                                                                                                                                                                                                                                            tf.__operators__.getitem_6[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.broadcast_to_1 (TFOpLambda)                                                                                                      (None, 1)                                                                               0                                               tf.__operators__.getitem_5[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.pad_1 (TFOpLambda)                                                                                                     (None, None, None)                                                                      0                                               tf.concat[0][0]                                                                                                                     
                                                                                                                                                                                                                                                                            tf.convert_to_tensor[0][0]                                                                                                          
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_10 (SlicingOpLambda)                                                                                       ()                                                                                      0                                               tf.compat.v1.shape_4[0][0]                                                                                                          
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.cast (TFOpLambda)                                                                                                                (None, None)                                                                            0                                               tf.compat.v1.transpose_1[0][0]                                                                                                      
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.concat_1 (TFOpLambda)                                                                                                            (None, None)                                                                            0                                               tf.ones[0][0]                                                                                                                       
                                                                                                                                                                                                                                                                            tf.broadcast_to_1[0][0]                                                                                                             
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.math.subtract_2 (TFOpLambda)                                                                                                     ()                                                                                      0                                               tf.__operators__.getitem_10[0][0]                                                                                                   
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.shape_3 (TFOpLambda)                                                                                                   (3,)                                                                                    0                                               tf.compat.v1.pad_1[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.where (TFOpLambda)                                                                                                               (None, None)                                                                            0                                               tf.cast[0][0]                                                                                                                       
                                                                                                                                                                                                                                                                            tf.concat_1[0][0]                                                                                                                   
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.convert_to_tensor_1 (TFOpLambda)                                                                                                 (2, 2)                                                                                  0                                               tf.math.floormod_1[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.zeros_2 (TFOpLambda)                                                                                                             (None, None)                                                                            0                                               tf.math.subtract_2[0][0]                                                                                                            
                                                                                                                                                                                                                                                                            tf.__operators__.getitem_5[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_9 (SlicingOpLambda)                                                                                        ()                                                                                      0                                               tf.compat.v1.shape_3[0][0]                                                                                                          
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.pad_2 (TFOpLambda)                                                                                                     (None, None)                                                                            0                                               tf.where[0][0]                                                                                                                      
                                                                                                                                                                                                                                                                            tf.convert_to_tensor_1[0][0]                                                                                                        
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.pad_5 (TFOpLambda)                                                                                                     (None, None)                                                                            0                                               tf.zeros_2[0][0]                                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.math.subtract_1 (TFOpLambda)                                                                                                     ()                                                                                      0                                               tf.__operators__.getitem_9[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.math.not_equal (TFOpLambda)                                                                                                      (None, None)                                                                            0                                               tf.compat.v1.pad_2[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.transpose_3 (TFOpLambda)                                                                                               (None, None)                                                                            0                                               tf.compat.v1.pad_5[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.zeros_1 (TFOpLambda)                                                                                                             (None, None)                                                                            0                                               tf.math.subtract_1[0][0]                                                                                                            
                                                                                                                                                                                                                                                                            tf.__operators__.getitem_5[0][0]                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.cast_3 (TFOpLambda)                                                                                                              (None, None)                                                                            0                                               tf.math.not_equal[0][0]                                                                                                             
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.cast_4 (TFOpLambda)                                                                                                              (None, None)                                                                            0                                               tf.compat.v1.transpose_3[0][0]                                                                                                      
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.pad_4 (TFOpLambda)                                                                                                     (None, None)                                                                            0                                               tf.zeros_1[0][0]                                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.eq (TFOpLambda)                                                                                                    (None, None)                                                                            0                                               tf.cast_3[0][0]                                                                                                                     
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.where_1 (TFOpLambda)                                                                                                             (None, None)                                                                            0                                               tf.cast_4[0][0]                                                                                                                     
                                                                                                                                                                                                                                                                            tf.math.floormod_2[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.compat.v1.transpose_2 (TFOpLambda)                                                                                               (None, None)                                                                            0                                               tf.compat.v1.pad_4[0][0]                                                                                                            
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.where_2 (TFOpLambda)                                                                                                             (None, None)                                                                            0                                               tf.__operators__.eq[0][0]                                                                                                           
                                                                                                                                                                                                                                                                            tf.where_1[0][0]                                                                                                                    
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.cast_1 (TFOpLambda)                                                                                                              (None, None)                                                                            0                                               tf.compat.v1.transpose_2[0][0]                                                                                                      
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
vtn_longformer_layer (VTNLongformerLayer)                                                                                           TFLongformerBaseModelOutputWithPooling(last_hidden_state=(None, None, 384), pooler_outp 19667712                                        tf.compat.v1.pad_2[0][0]                                                                                                            
                                                                                                                                                                                                                                                                            tf.compat.v1.pad_1[0][0]                                                                                                            
                                                                                                                                                                                                                                                                            tf.where_2[0][0]                                                                                                                    
                                                                                                                                                                                                                                                                            tf.cast_1[0][0]                                                                                                                     
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
tf.__operators__.getitem_11 (SlicingOpLambda)                                                                                       (None, 384)                                                                             0                                               vtn_longformer_layer[0][0]                                                                                                          
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
layer_normalization_1 (LayerNormalization)                                                                                          (None, 384)                                                                             768                                             tf.__operators__.getitem_11[0][0]                                                                                                   
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
dense (Dense)                                                                                                                       (None, 384)                                                                             147840                                          layer_normalization_1[0][0]                                                                                                         
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
dropout_13 (Dropout)                                                                                                                (None, 384)                                                                             0                                               dense[0][0]                                                                                                                         
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
dense_1 (Dense)                                                                                                                     (None, 16)                                                                              6160                                            dropout_13[0][0]                                                                                                                    
================================================================================================================================================================================================================================================================================================================================================================================================================
Total params: 23,582,899
Trainable params: 23,542,668
Non-trainable params: 40,231
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________